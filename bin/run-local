#!/bin/bash

source "$(dirname "${BASH_SOURCE}")"/imos-variables || exit 1
DEFINE_string map 'sample' 'Map'
IMOSH_PREDICATE=1 eval "${IMOSH_INIT}"

cd "$(dirname "${BASH_SOURCE}")"
WRAPPER="$(pwd)/wrapper"
cd - >/dev/null

args=()
for arg in "$@"; do
  args+=("cd $(pwd); ${WRAPPER} ${arg}")
done

bazel run -c opt //sulume:run-local -- --map="${FLAGS_map}" "${args[@]}"
